<!-- Layout avec sidebar -->
<div class="d-flex min-vh-100 bg-light">
  <!-- Sidebar -->
  <div class="bg-white shadow-sm border-end" style="width: 280px; min-height: 100vh;">
    <!-- Logo -->
    <div class="p-4 border-bottom">
      <div class="d-flex align-items-center">
        <div class="bg-warning rounded-3 p-2 me-3">
          <span class="text-white fw-bold">SC</span>
        </div>
        <span class="fw-semibold text-dark">SICA CONSEIL</span>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="p-3">
      <div class="d-grid gap-2">
        <p-button
          *ngFor="let item of sidebarItems"
          [label]="item.label"
          [icon]="'pi pi-' + item.icon"
          (onClick)="onSidebarItemClick(item)"
          class="justify-content-start text-start"
          [severity]="item.active ? 'warning' : 'secondary'"
          [text]="!item.active"
          [outlined]="item.active">
        </p-button>
      </div>
    </nav>

    <!-- D√©connexion -->
    <div class="p-3 mt-auto border-top">
      <p-button
        label="D√©connexion"
        icon="pi pi-sign-out"
        severity="danger"
        [text]="true"
        class="w-100"
        (onClick)="onLogout()">
      </p-button>
    </div>
  </div>

  <!-- Contenu principal -->
  <div class="flex-fill p-4">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="h2 fw-bold text-dark mb-1">Entra√Ænement par domaine</h1>
        <p class="text-muted">Concentrez-vous sur vos points faibles avec des questions cibl√©es</p>
      </div>
      <div class="d-flex gap-2">
        <p-button
          label="Retour au simulateur"
          [outlined]="true"
          severity="secondary"
          (onClick)="onReturnToSimulator()">
        </p-button>
        <p-button
          label="Formation"
          icon="pi pi-book"
          severity="warning"
          (onClick)="onAccessFormation()">
        </p-button>
      </div>
    </div>

    <!-- Vue d'ensemble des domaines -->
    <p-card class="mb-4 border-0 shadow-sm">
      <ng-template pTemplate="header">
        <div class="p-4 border-bottom">
          <h2 class="h4 fw-semibold text-dark mb-2">Vue d'ensemble des domaines</h2>
          <p class="text-muted small mb-0">L'examen PMP est structur√© autour de 3 domaines principaux selon le PMI</p>
        </div>
      </ng-template>
      
      <div class="p-4">
        <div class="row g-4">
          <div class="col-md-4" *ngFor="let domain of domains">
            <p-card class="h-100 border-0 shadow-sm">
              <!-- Header du domaine -->
              <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="d-flex align-items-center">
                  <div class="rounded-3 d-flex align-items-center justify-content-center text-white fw-bold me-3"
                       style="width: 50px; height: 50px;"
                       [style.background-color]="domain.color">
                    {{ domain.iconText }}
                  </div>
                  <div>
                    <h3 class="h6 fw-semibold text-dark mb-1">{{ domain.name }}</h3>
                    <span class="badge bg-light text-dark">{{ domain.percentage }}% de l'examen</span>
                  </div>
                </div>
                <span class="badge text-white"
                      [style.background-color]="domain.color">
                  {{ domain.questions }} questions
                </span>
              </div>

              <!-- Description -->
              <p class="text-muted small mb-3">{{ domain.description }}</p>

              <!-- Score actuel -->
              <div class="mb-3">
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <span class="fw-medium text-dark">Score actuel</span>
                  <span class="h5 fw-bold mb-0" [style.color]="getScoreColor(domain.currentScore)">
                    {{ domain.currentScore }}%
                  </span>
                </div>
                <div class="progress mb-2" style="height: 8px;">
                  <div class="progress-bar" 
                       [style.width.%]="getProgressWidth(domain.currentScore)"
                       [style.background-color]="getScoreColor(domain.currentScore)">
                  </div>
                </div>
                <div class="d-flex justify-content-between">
                  <small class="text-muted">Seuil: {{ domain.threshold }}%</small>
                  <small class="text-muted">{{ domain.level }}</small>
                </div>
              </div>

              <!-- Bouton d'entra√Ænement -->
              <p-button
                label="S'entra√Æner"
                icon="pi pi-play"
                severity="warning"
                class="w-100"
                (onClick)="onTrainDomain(domain.id)">
              </p-button>
            </p-card>
          </div>
        </div>
      </div>
    </p-card>

    <!-- D√©tails des domaines -->
    <div class="row g-4 mb-4">
      <div class="col-12" *ngFor="let domain of domains">
        <p-card class="border-0 shadow-sm">
          <!-- Header du domaine d√©taill√© -->
          <div class="d-flex align-items-center mb-4">
            <div class="rounded-3 d-flex align-items-center justify-content-center text-white fw-bold me-3"
                 style="width: 60px; height: 60px;"
                 [style.background-color]="domain.color">
              {{ domain.iconText }}
            </div>
            <div>
              <h3 class="h4 fw-semibold text-dark mb-1">{{ domain.name }}</h3>
              <p class="text-muted mb-0">{{ domain.questions }} questions ({{ domain.percentage }}% de l'examen)</p>
            </div>
          </div>

          <div class="row g-4">
            <!-- Sujets couverts -->
            <div class="col-lg-6">
              <h4 class="h6 fw-semibold text-dark mb-3">Sujets couverts :</h4>
              <ul class="list-unstyled">
                <li *ngFor="let subject of domain.subjects" class="d-flex align-items-start mb-2">
                  <i class="pi pi-circle-fill text-muted me-2 mt-1" style="font-size: 0.5rem;"></i>
                  <span class="text-muted">{{ subject }}</span>
                </li>
              </ul>
            </div>

            <!-- Performance et actions -->
            <div class="col-lg-6">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h4 class="h6 fw-semibold text-dark mb-0">Performance actuelle</h4>
                <span class="h4 fw-bold mb-0" [style.color]="getScoreColor(domain.currentScore)">
                  {{ domain.currentScore }}%
                </span>
              </div>
              
              <div class="progress mb-4" style="height: 12px;">
                <div class="progress-bar" 
                     [style.width.%]="getProgressWidth(domain.currentScore)"
                     [style.background-color]="getScoreColor(domain.currentScore)">
                </div>
              </div>

              <div class="d-grid gap-2">
                <p-button
                  label="Test approfondi (30 questions - 55 min)"
                  icon="pi pi-calculator"
                  severity="warning"
                  (onClick)="onTakeTest(domain.id)">
                </p-button>
                
                <p-button
                  label="√âtudier"
                  icon="pi pi-book"
                  [outlined]="true"
                  severity="secondary"
                  (onClick)="onStudyDomain(domain.id)">
                </p-button>
              </div>
            </div>
          </div>
        </p-card>
      </div>
    </div>

    <!-- Strat√©gie d'entra√Ænement recommand√©e -->
    <p-card class="border-0 shadow-sm" 
            style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);">
      <ng-template pTemplate="header">
        <div class="p-4 border-bottom">
          <div class="d-flex align-items-center">
            <div class="rounded-circle d-flex align-items-center justify-content-center me-3"
                 style="width: 50px; height: 50px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);">
              <span class="fs-4">üéØ</span>
            </div>
            <h3 class="h4 fw-semibold text-dark mb-0">Strat√©gie d'entra√Ænement recommand√©e</h3>
          </div>
        </div>
      </ng-template>
      
      <div class="p-4">
        <div class="row g-4">
          <div class="col-md-4" *ngFor="let strategy of trainingStrategy">
            <div class="text-center">
              <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3"
                   style="width: 80px; height: 80px;"
                   [style.background-color]="strategy.color + '20'">
                <span class="fs-1" [style.color]="strategy.color">{{ strategy.icon }}</span>
              </div>
              <div class="fw-semibold text-dark mb-2">
                {{ strategy.step }}. {{ strategy.title }}
              </div>
              <p class="text-muted small mb-0">{{ strategy.description }}</p>
            </div>
          </div>
        </div>
      </div>
    </p-card>
  </div>
</div>